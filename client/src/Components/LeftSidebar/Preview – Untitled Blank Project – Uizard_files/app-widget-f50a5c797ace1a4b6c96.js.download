!function(t){var e={};function r(n){if(e[n])return e[n].exports;var s=e[n]={i:n,l:!1,exports:{}};return t[n].call(s.exports,s,s.exports,r),s.l=!0,s.exports}r.m=t,r.c=e,r.d=function(t,e,n){r.o(t,e)||Object.defineProperty(t,e,{enumerable:!0,get:n})},r.r=function(t){"undefined"!==typeof Symbol&&Symbol.toStringTag&&Object.defineProperty(t,Symbol.toStringTag,{value:"Module"}),Object.defineProperty(t,"__esModule",{value:!0})},r.t=function(t,e){if(1&e&&(t=r(t)),8&e)return t;if(4&e&&"object"===typeof t&&t&&t.__esModule)return t;var n=Object.create(null);if(r.r(n),Object.defineProperty(n,"default",{enumerable:!0,value:t}),2&e&&"string"!=typeof t)for(var s in t)r.d(n,s,function(e){return t[e]}.bind(null,s));return n},r.n=function(t){var e=t&&t.__esModule?function(){return t.default}:function(){return t};return r.d(e,"a",e),e},r.o=function(t,e){return Object.prototype.hasOwnProperty.call(t,e)},r.p="/assets/packs/",r(r.s=1347)}({1347:function(t,e,r){"use strict";r.r(e);r(985);function n(t,e,r){return{h:t,s:e,l:r,lighten:function(s){return n(t,e,r+s)},darken:function(s){return n(t,e,r-s)},toString:function(){return"hsl(".concat(t,", ").concat(e,"%, ").concat(r,"%)")}}}function s(t){var e=0,r=0,s=0;4==t.length?(e="0x"+t[1]+t[1],r="0x"+t[2]+t[2],s="0x"+t[3]+t[3]):7==t.length&&(e="0x"+t[1]+t[2],r="0x"+t[3]+t[4],s="0x"+t[5]+t[6]),e/=255,r/=255,s/=255;var o=Math.min(e,r,s),i=Math.max(e,r,s),a=i-o,l=0,h=0;return l=0==a?0:i==e?(r-s)/a%6:i==r?(s-e)/a+2:(e-r)/a+4,(l=Math.round(60*l))<0&&(l+=360),h=(i+o)/2,n(l,+(100*(0==a?0:a/(1-Math.abs(2*h-1)))).toFixed(1),h=+(100*h).toFixed(1))}function o(t,e){return function(t){if(Array.isArray(t))return t}(t)||function(t,e){var r=null==t?null:"undefined"!=typeof Symbol&&t[Symbol.iterator]||t["@@iterator"];if(null!=r){var n,s,o,i,a=[],l=!0,h=!1;try{if(o=(r=r.call(t)).next,0===e){if(Object(r)!==r)return;l=!1}else for(;!(l=(n=o.call(r)).done)&&(a.push(n.value),a.length!==e);l=!0);}catch(c){h=!0,s=c}finally{try{if(!l&&null!=r.return&&(i=r.return(),Object(i)!==i))return}finally{if(h)throw s}}return a}}(t,e)||function(t,e){if(!t)return;if("string"===typeof t)return i(t,e);var r=Object.prototype.toString.call(t).slice(8,-1);"Object"===r&&t.constructor&&(r=t.constructor.name);if("Map"===r||"Set"===r)return Array.from(t);if("Arguments"===r||/^(?:Ui|I)nt(?:8|16|32)(?:Clamped)?Array$/.test(r))return i(t,e)}(t,e)||function(){throw new TypeError("Invalid attempt to destructure non-iterable instance.\nIn order to be iterable, non-array objects must have a [Symbol.iterator]() method.")}()}function i(t,e){(null==e||e>t.length)&&(e=t.length);for(var r=0,n=new Array(e);r<e;r++)n[r]=t[r];return n}function a(t,e){var r=s(e),n={body:{"background-color":["#fff",r.lighten(15)]},".innercont":{color:["#222c36",r.lighten(85)]},".topBar, .bottomBar, .footer":{"border-color":["#f1f1f1",r.lighten(6)]},".topBar, .bottomBar":{"background-color":["#fff",r.lighten(10)]},".footer":{"background-color":["#fcfcfc",r.lighten(10)]}};Object.entries(n).forEach((function(e){var r=o(e,2),s=r[0];r[1];document.querySelectorAll(s).forEach((function(e){Object.entries(n[s]).forEach((function(r){var n=o(r,2),s=n[0],i=n[1];e.style[s]=i[t]}))}))}))}var l,h=function(t,e){return function(){return t.apply(e,arguments)}},c=[].indexOf||function(t){for(var e=0,r=this.length;e<r;e++)if(e in this&&this[e]===t)return e;return-1},u={}.hasOwnProperty;l=function(){function t(){this.log=h(this.log,this)}return t.prototype.CODENAME="CaptainAmerica",t.prototype.postMessage=function(){var t,e,r;return e=(t=Array.prototype.slice.call(arguments)).shift(),r=t,window.parent.postMessage([this.CODENAME,e,r],"*")},t.prototype.setStyles=function(t,e){var r,n;for(r in n=[],e)n.push(t.style[r]=e[r]);return n},t.prototype.log=function(){if(this.options.debug)return console.log("[Headway Debug]",arguments)},t.prototype.diff=function(t,e){return t.filter((function(t){return c.call(e,t)<0}))},t}(),window.App=function(t){function e(t){this.applyTranslations=h(this.applyTranslations,this),this.replaceBaseUrl=h(this.replaceBaseUrl,this),this.setDetailsHeight=h(this.setDetailsHeight,this),this.setListHeight=h(this.setListHeight,this),this.serverStore=h(this.serverStore,this),this.trackEvent=h(this.trackEvent,this),this.markSeen=h(this.markSeen,this),this.markRead=h(this.markRead,this),this.markAllSeen=h(this.markAllSeen,this),this.markItems=h(this.markItems,this),this.setState=h(this.setState,this),this.initState=h(this.initState,this),this.badgeCount=h(this.badgeCount,this),this.reload=h(this.reload,this),this.refresh=h(this.refresh,this),this.getCurrentIds=h(this.getCurrentIds,this),this.migrateLocalStorage=h(this.migrateLocalStorage,this),this.onceReady=h(this.onceReady,this),this.showDetails=h(this.showDetails,this),this.showIndex=h(this.showIndex,this),this.wheneverClosed=h(this.wheneverClosed,this),this.setBadge=h(this.setBadge,this),this.wheneverOpened=h(this.wheneverOpened,this),this.readMessage=h(this.readMessage,this),this.makeInaccessible=h(this.makeInaccessible,this),this.makeAccessible=h(this.makeAccessible,this),this.removeOutlineOnClick=h(this.removeOutlineOnClick,this),this.setupDefaults=h(this.setupDefaults,this),this.getCategories=h(this.getCategories,this),this.getChangelogs=h(this.getChangelogs,this),e.__super__.constructor.call(this),this.options=t,this.elements={logItems:document.querySelectorAll(".logItem"),backLinks:document.querySelectorAll(".back"),indexCont:document.getElementById("index"),logDetailsItem:document.querySelectorAll(".logDetailsItem"),innercont:document.querySelector(".innercont"),title:document.querySelector("h3"),readMore:document.querySelectorAll(".link a"),seeMore:document.querySelector(".footer a"),footer:document.querySelector(".footer")},this.current={data:null},this.setupDefaults(),document.body.classList.add("light-mode"),a(0,"#fff"),document.body.classList.add("right"),document.body.classList.add("bottom"),this.log("App.constructor",this.options,this.elements,this.current)}return function(t,e){for(var r in e)u.call(e,r)&&(t[r]=e[r]);function n(){this.constructor=t}n.prototype=e.prototype,t.prototype=new n,t.__super__=e.prototype}(e,t),e.prototype.getChangelogs=function(){var t,e,r,n,s,o,i,a,l,h,c;if(this.changelogs)return this.changelogs;for(this.changelogs=[],r=s=0,o=(l=this.elements.logItems).length;s<o;r=++s)c=l[r],n=parseInt(c.dataset.id),e=(a=(i=this.elements.logDetailsItem[r]).querySelector(".content noscript")).textContent||a.innerHTML,t=[],this.getCategories(n).forEach((function(e){return t.push(e.name)})),this.changelogs.push({id:n,title:null!=(h=c.querySelector(".title"))?h.innerText:void 0,categories:t,content:{short:c.querySelector(".short").innerHTML,long:e,more:!!i.querySelector("a.more")},dateTime:new Date(c.dataset.date),url:i.querySelector(".link a").href});return this.changelogs},e.prototype.getCategories=function(t){return window.categories[t]},e.prototype.setupDefaults=function(){var t,e,r,n,s,o,i,a,l,h;for(a=this.elements.logItems,h=this,t=function(t,e){var r,n,s,o,i,a,l;return s=parseInt(t.dataset.id),r=h.getCategories(s),n={position:e+1,id:s,title:(null!=(i=t.querySelector(".title"))?i.innerText.replace(/\.$/,""):void 0)||"",category:null!=(a=r[0])&&null!=(l=a.name)?l.toLowerCase():void 0,categories:r},null!=(o=h.elements.logDetailsItem[e].querySelector(".link a"))&&o.addEventListener("click",(function(){return h.postMessage("setAction",{event:"onReadMore",data:n})})),h.removeOutlineOnClick(t),t.addEventListener("click",(function(r){return r.stopPropagation(),r.preventDefault(),h.showDetails(e),h.trackEvent("/r/read/"+h.accountId+"/"+t.dataset.id),h.markRead(t.dataset.id),h.postMessage("setAction",{event:"onShowDetails",data:n})}))},e=r=0,s=a.length;r<s;e=++r)t(i=a[e],e);for(n=0,o=(l=this.elements.backLinks).length;n<o;n++)i=l[n],this.removeOutlineOnClick(i),i.addEventListener("click",function(t){return function(e){return e.stopPropagation(),e.preventDefault(),t.showIndex()}}(this));if(this.elements.logItems.length>0)return window.addEventListener("message",function(t){return function(e){var r,n,s,o;if(s=(r=e.data)[0],o=r[1],n=r[2],s===t.CODENAME)return t.readMessage(o,n)}}(this))},e.prototype.removeOutlineOnClick=function(t){return t.addEventListener("click",(function(){return t.classList.add("noOutline")})),t.addEventListener("blur",(function(){return t.classList.remove("noOutline")}))},e.prototype.makeAccessible=function(t){var e,r,n,s,o;for(t.removeAttribute("aria-hidden"),o=[],e=0,r=(s=t.querySelectorAll("a")).length;e<r;e++)n=s[e],o.push(n.removeAttribute("tabindex"));return o},e.prototype.makeInaccessible=function(t){var e,r,n,s,o;for(t.setAttribute("aria-hidden","true"),o=[],e=0,r=(s=t.querySelectorAll("a")).length;e<r;e++)n=s[e],o.push(n.setAttribute("tabindex","-1"));return o},e.prototype.readMessage=function(t,e){switch(t){case"opened":return this.wheneverOpened();case"closed":return this.wheneverClosed();case"ready":return this.onceReady(e[0]);case"markSeen":return this.markSeen(e[0]);case"markAllSeen":return this.markAllSeen();case"markRead":return this.markRead(e[0]);case"reload":return this.reload()}},e.prototype.wheneverOpened=function(){if(this.showIndex(),this.visible=!0,!this.options.embed)return this.markAllSeen(),this.trackEvent("/r/open/"+this.accountId)},e.prototype.setBadge=function(){return this.postMessage("setBadge",this.badgeCount())},e.prototype.wheneverClosed=function(){return this.visible=!1,setTimeout(this.showIndex,300)},e.prototype.showIndex=function(){var t,e,r,n,s;for(this.elements.innercont.classList.remove("detailsOpen"),this.setListHeight(),this.makeAccessible(this.elements.indexCont),s=[],e=0,r=(n=this.elements.logDetailsItem).length;e<r;e++)t=n[e],s.push(this.makeInaccessible(t));return s},e.prototype.showDetails=function(t){var e,r,n,s;for(this.elements.innercont.classList.add("detailsOpen"),this.setDetailsHeight(t),this.makeInaccessible(this.elements.indexCont),r=0,n=(s=this.elements.logDetailsItem).length;r<n;r++)e=s[r],this.makeInaccessible(e);return this.makeAccessible(this.elements.logDetailsItem[t])},e.prototype.onceReady=function(t){if(document.body.classList.remove("right","center","left","top","bottom"),t.newWidgetPositioning?(document.body.classList.add(t.position.x||"right"),document.body.classList.add(t.position.y||"bottom")):(document.body.classList.add("right"),document.body.classList.add("bottom")),this.options.embed=t.options.embed,this.options.debug=t.options.debug,this.options.baseUrl=t.options.baseUrl,this.token=t.options.token,this.current.data=t,this.localStorage=t.localStorage,this.accountId=t.options.account,this.applyTranslations(document.getElementById("index")),this.migrateLocalStorage())return this.initState(),this.markItems("read"),this.markItems("seen"),setTimeout(this.refresh,6e4),null!=this.elements.seeMore&&this.options.baseUrl&&(this.elements.seeMore.href=this.options.baseUrl),this.setListHeight(),this.postMessage("widgetReady",{options:this.options,changelogs:this.getChangelogs(),state:this.state,badgeCount:this.badgeCount()}),this.log("App.setupDefaults#ready",t)},e.prototype.migrateLocalStorage=function(){return"server"!==this.options.activeStorage||null==this.token||!this.localStorage.seen.length&&!this.localStorage.read.length||(this.serverStore("/r/seen/"+this.accountId,"token="+this.token+"&seen="+this.localStorage.seen.join(","),(t=this,function(){return t.serverStore("/r/read/"+t.accountId,"token="+t.token+"&read="+t.localStorage.read.join(","),(function(){return t.postMessage("migrateLocalStorage")}))})),!1);var t},e.prototype.getCurrentIds=function(){var t,e,r,n,s;for(s=[],r=0,n=(e=Array.prototype.slice.call(this.elements.logItems)).length;r<n;r++)t=e[r],s.push(parseInt(t.dataset.id));return s},e.prototype.refresh=function(){if(this.options.autorefresh)return!0===this.visible?setTimeout(this.refresh,200):this.reload()},e.prototype.reload=function(){return document.location.reload()},e.prototype.badgeCount=function(){var t,e,r,n,s,o,i,a;if("server"===this.options.activeStorage&&null==this.token)return 0;for(e=this.options.expireAfter||Infinity,t=0,a=(new Date).getTime(),s=0,o=(i=document.querySelectorAll(".logItem")).length;s<o;s++)"true"!==(r=i[s]).dataset.seen&&(n=new Date(r.dataset.date).getTime(),Math.floor((a-n)/864e5)>=e||(t+=1));return t},e.prototype.initState=function(){return this.state="server"===this.options.activeStorage?this.options.state||{read:[],seen:[]}:this.localStorage},e.prototype.setState=function(t,e){return this.state[t]=e,this.postMessage("setState",this.state),this.markItems(t),this.setBadge()},e.prototype.markItems=function(t){var e,r,n,s,o,i;if((r=this.state[t]).length>0){for(i=[],s=0,o=r.length;s<o;s++)e=r[s],(n=document.querySelector("*[data-id='"+e+"']"))?(n.dataset[t]=!0,i.push(n.classList.add(t))):i.push(void 0);return i}},e.prototype.markAllSeen=function(){var t,e;if(e=function(){var e,r,n,s;for(s=[],e=0,r=(n=this.getChangelogs().reverse()).length;e<r;e++)t=n[e],s.push(t.id);return s}.call(this),this.setState("seen",this.diff(this.state.seen,e).concat(e)),"server"===this.options.activeStorage)return this.serverStore("/r/seen/"+this.accountId,"token="+this.token+"&seen="+e.join(","))},e.prototype.markRead=function(t){if(this.setState("read",this.diff(this.state.read,[t]).concat([t])),"server"===this.options.activeStorage)return this.serverStore("/r/read/"+this.accountId,"token="+this.token+"&read="+t)},e.prototype.markSeen=function(t){if(this.setState("seen",this.diff(this.state.seen,[t]).concat([t])),"server"===this.options.activeStorage)return this.serverStore("/r/seen/"+this.accountId,"token="+this.token+"&seen="+t)},e.prototype.trackEvent=function(t){if(this.options.track)return this.xhr(t)},e.prototype.serverStore=function(t,e,r){if(null==e&&(e=""),this.token)return this.xhr(t,e,r)},e.prototype.xhr=function(t,e,r){var n;return null==e&&(e=""),(n=new XMLHttpRequest).open("POST",t),n.setRequestHeader("Content-Type","application/x-www-form-urlencoded"),n.onreadystatechange=function(){if(4===this.readyState&&200===this.status&&null!=r)return r()},n.send(e)},e.prototype.setListHeight=function(){var t,e,r,n;return n=(e=document.getElementById("index")).querySelector(".topBar").offsetHeight,r=e.querySelector(".logList").scrollHeight,t=e.querySelector(".footer").offsetHeight,this.postMessage("setHeight",{height:n+r+t})},e.prototype.setDetailsHeight=function(t){var e,r,n,s,o,i,a,l,h,c,u,d,p,f,g,m,y,v;for(a=0,c=(p=this.elements.logDetailsItem).length;a<c;a++)i=p[a],this.setStyles(i,{display:"none"});if(n=this.elements.logDetailsItem[t].querySelector("noscript")){for(e=(e=n.innerHTML).replace(/&gt;/g,">").replace(/&lt;/g,"<").replace(/&amp;/g,"&"),(y=n.parentNode).innerHTML=e,s=y.parentNode.querySelector(".logDetailsItem .link a").href,l=0,u=(f=y.querySelectorAll("img")).length;l<u;l++)(o=f[l]).width>300&&o.classList.add("bigImage");for(h=0,d=(g=y.querySelectorAll(".videoThumbWidth, .bigImage")).length;h<d;h++)g[h].addEventListener("click",(function(){return window.open(s)}));this.addTargetBlank(this.elements.logDetailsItem[t]),this.replaceBaseUrl(this.elements.logDetailsItem[t]),this.applyTranslations(y)}return this.setStyles(this.elements.logDetailsItem[t],{display:""}),v=this.elements.logDetailsItem[t].querySelector(".topBar").offsetHeight,m=this.elements.logDetailsItem[t].querySelector(".slideBody").scrollHeight,r=this.elements.logDetailsItem[t].querySelector(".bottomBar").offsetHeight,this.postMessage("setHeight",{height:v+m+r})},e.prototype.replaceBaseUrl=function(t){var e,r;if(r=t.querySelector(".link a"),this.options.baseUrl&&null!=r)return e=r.dataset.path,r.href=this.options.baseUrl+e},e.prototype.addTargetBlank=function(t){var e,r,n,s,o;for(o=[],e=0,r=(s=t.querySelectorAll(".slideBody a")).length;e<r;e++)(n=s[e]).target="_blank",o.push(n.rel="noopener noreferrer");return o},e.prototype.applyTranslations=function(t){var e,r,n,s,o,i,a,l;if((null!=(o=this.current.data)?o.options.translations:void 0)&&(null!=(l=this.current.data.options.translations).title&&(this.elements.title.textContent=l.title),null!=l.footer&&((s=document.createElement("a")).target="_blank",s.href=this.elements.seeMore.href,s.innerText=l.footer,this.elements.footer.innerHTML="",this.elements.footer.appendChild(s)),null!=l.labels&&t.querySelectorAll(".category").forEach((function(t){var e;if(e=l.labels[t.innerText.toLowerCase()])return t.innerText=e})),null!=l.readMore)){for(a=[],r=0,n=(i=this.elements.readMore).length;r<n;r++)e=i[r],a.push(e.textContent=l.readMore);return a}},e}(l)},985:function(t,e,r){}});
//# sourceMappingURL=app-widget-f50a5c797ace1a4b6c96.js.map